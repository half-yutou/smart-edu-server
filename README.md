# SmartEduHub_server
选题要求：
数智教育资源管理平台（含视频点播、作业批改功能）
- 背景意义：学校或培训机构需整合海量教育资源（如教学视频、课件、作业），同时实现作业在线提交与自动化批改，提升教学管理效率。该平台可解决资源分散、批改工作量大的问题。
- 设计要求：实现教育资源分类存储与检索（支持按学科、年级筛选）；集成视频点播功能（支持倍速、弹幕）；利用 OCR 识别作业内容，结合规则引擎实现客观题自动批改，主观题标注批改建议。
- 目标：资源检索响应时间小于 1 秒，视频点播流畅度（无卡顿）达 95%，客观题批改准确率 100%，支持教师手动批改主观题与成绩统计导出。
- 培养能力：数据库设计与优化能力、视频流媒体技术应用能力、OCR 文字识别能力、系统模块化开发与集成能力。

## 1. 技术栈选型
- **语言**: Go (1.24)
- **Web框架**: Gin
- **数据库**: PostgreSQL
- **缓存**: Redis (前期预留接口，暂不部署)
- **对象存储**: 阿里云 OSS (Aliyun Object Storage Service)
- **OCR 服务**: 百度 AI 开放平台 OCR API

## 2. 功能模块划分

### 2.1 用户中心 (User Center)
- **功能**: 用户注册、登录、个人信息管理。
- **角色**:
    - **学生 (Student)**: 加入班级、浏览班级资源/全站资源、看视频、发弹幕、写作业。
    - **教师 (Teacher)**: 创建/管理班级、上传资源、发布作业到班级、批改主观题、查看统计。
    - **管理员 (Admin)**: 用户管理、基础数据维护 (学科/年级)。

### 2.2 班级管理 (Class Management)
- **功能**:
    - **班级创建与维护**: 教师创建班级，设置年级、学科、班级名称。生成唯一**班级码**。
    - **学生加入**: 学生输入班级码加入班级。
    - **班级资源**: 教师将全站资源库中的资源“添加”到班级，供班级学生查看。

### 2.3 资源管理 (Resource Management)
- **功能**:
    - 资源的上传 (视频、课件文档) -> 上传至阿里云 OSS。
    - 资源的分类与检索 (按学科、年级、类型)。
    - 视频点播支持 (基于 OSS URL)。
- **核心点**: 阿里云 OSS 集成、资源与班级的关联。

### 2.4 互动模块 (Interaction)
- **功能**: 视频弹幕的发送与拉取。
- **核心点**: 弹幕的时间轴同步。

### 2.5 作业系统 (Homework System)
- **功能**:
    - **作业发布**: 教师针对**特定班级**发布作业。
    - **作业提交**: 学生上传作业（文本或图片）。
    - **OCR 识别与自动批改**: 调用百度 OCR 识别图片内容，结合规则自动批改客观题。
    - **人工批改**: 教师对主观题评分和评语。
    - **成绩统计**: 导出班级成绩报表。

## 班级管理

### 通用
- 查询单个班级信息：需要班级码(任何用户) 或 班级ID(班级成员)。
  
### 教师
- **创建班级**: 教师可以创建班级，设置班级名称、年级、学科。且生成**唯一班级码**。
- **修改班级**: 教师可以修改班级的名称、年级、学科。
- **删除班级**: 教师可以删除班级。
- **查询班级**: 教师可以查询所有班级的信息（班级码、名称、年级、学科）。
  
### 学生
- **加入班级**: 学生可以通过班级码加入班级。
- **退出班级**: 学生可以退出已加入的班级。
- **查询班级**: 学生可以查询所有已加入的班级信息（班级码、名称、年级、学科）。
  
## 资源管理

### 管理员/教师 (上传者)
- **上传资源**:
    - 核心流程：文件上传至 OSS -> 获取 URL -> 后端保存元数据。
    - 元数据包括：标题、描述、类型(视频/文档)、URL、学科、年级、时长。
- **我的资源**: 查询当前用户上传的资源列表。
- **编辑资源**: 修改资源的标题、描述等信息。
- **删除资源**: 移除资源记录。

### 公共/学生 (消费者)
- **资源广场**:
    - 全局资源检索。
    - 支持筛选：学科 (Subject)、年级 (Grade)、类型 (ResType)。
    - 支持分页与排序 (默认按时间倒序)。
- **资源详情**: 获取单个资源的详细信息 (用于播放或预览)。

## 3. 作业系统 (Homework System)

### 3.1 基础设施 (Infrastructure)
- [ ] **集成 AI 服务**:
    - **百度 OCR**: 用于识别学生上传的手写/打印作业图片。
    - **DeepSeek LLM**: 用于根据题目、参考答案和 OCR 识别结果进行智能批改。

### 3.2 教师端功能 (Teacher)
- [ ] **发布作业**:
    - 在指定班级创建作业。
    - 添加题目 (单选 Choice / 简答 Text)。
    - 设置截止时间。
- [ ] **作业管理**:
    - 查看班级作业列表。
    - 查看作业详情 (题目内容)。
- [ ] **批改作业**:
    - 查看学生的提交列表。
    - 查看 AI 预批改结果 (分数/评语)。
    - **人工复核**: 手动修改分数和评语 (Finalize Grade)。

### 3.3 学生端功能 (Student)
- [ ] **我的作业**:
    - 查看待完成/已完成作业列表。
- [ ] **提交作业**:
    - 针对每一题上传答案图片 (或输入文本)。
    - **核心流程**: 上传图片 -> 后端调用 OCR 识别文字 -> 后端调用 DeepSeek 批改 -> 保存提交记录。
- [ ] **查看结果**:
    - 查看 AI 评语和最终得分。

### 3.4 AI 批改流水线 (AI Pipeline)
1.  **OCR 阶段**: 接收图片 -> 提取文本 (Text Extraction)。
2.  **LLM 阶段**:
    - 输入: 题目内容 + 标准答案 + 学生答案(OCR文本)。
    - Prompt: "你是一个助教。请根据标准答案判断学生答案的正确性。客观题严格判分，主观题给出改进建议和预估分。"
    - 输出: JSON 格式 (Score, Comment, IsCorrect)。
